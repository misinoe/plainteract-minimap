!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Minimap=e()}(this,function(){"use strict";var t,e,i=(t=function(t){!function(e){var i=function(t){return a(!0===t,!1,arguments)};i.recursive=function(t){return a(!0===t,!0,arguments)},i.clone=function(t){var e,n,a=t,o=r(t);if("array"===o)for(a=[],n=t.length,e=0;e<n;++e)a[e]=i.clone(t[e]);else if("object"===o){a={};for(e in t)a[e]=i.clone(t[e])}return a};function n(t,e){if("object"!==r(t))return e;for(var i in e)"object"===r(t[i])&&"object"===r(e[i])?t[i]=n(t[i],e[i]):t[i]=e[i];return t}function a(t,e,a){var o=a[0],h=a.length;(t||"object"!==r(o))&&(o={});for(var l=0;l<h;++l){var s=a[l];if("object"===r(s))for(var c in s){var d=t?i.clone(s[c]):s[c];o[c]=e?n(o[c],d):d}}return o}function r(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}e?t.exports=i:window.merge=i}(t&&t.exports)},e=void 0,t(e={exports:{}},e.exports),e.exports),n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=Math.PI/180;return function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t);var r=i.recursive(!0,{background:{fillStyle:"rgba(0, 0, 0, 0.5)",strokeStyle:"rgba(0, 0, 0, 0.9)",lineWidth:1},node:{radius:5,fillStyle:"rgba(255, 255, 255, 0.2)",strokeStyle:"rgba(255, 255, 255, 0.5)",lineWidth:1},nodeActive:{radius:5,fillStyle:"rgba(255, 255, 255, 0.5)",strokeStyle:"rgba(255, 255, 255, 0.8)",lineWidth:4},nodeHighlight:{radius:5,fillStyle:"rgba(200, 240, 255, 0.7)",strokeStyle:"rgba(64, 128, 255, 0.9)",lineWidth:3},corn:{}},a.style||{});this.style=r;this.canvas=document.createElement("canvas");this.setMinimapData(e),this.direction=0,this.perspective=90,this.activeName="",this.highlightName=""}return a(t,[{key:"setMinimapData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.data=i.recursive(!0,{viewRect:{x:0,y:0,width:100,height:100},fieldRect:"auto",nodes:[]},t),"auto"===this.data.fieldRect){var e=16777215,n=16777215,a=0,r=0;this.data.nodes.forEach(function(t){var i=t.position;e=Math.min(i.x,e),n=Math.min(i.y,n),a=Math.max(i.x,a),r=Math.max(i.y,r)}),this.data.fieldRect={x:e-10,y:n-10,width:a-e+20,height:r-n+20}}var o=this.canvas,h=this.data.viewRect;o.width=h.width,o.height=h.height,this.update()}},{key:"update",value:function(){var t=this.canvas,e=this.data,i=t.getContext("2d"),n=e.viewRect,a=e.fieldRect;a.y,a.height,a.x,a.width;i.clearRect(1,1,n.width,n.height),i.fillStyle=this.style.background.fillStyle,i.fillRect(1,1,n.width,n.height);var r=this.style.node.radius,o=e.nodes,h=!0,l=!1,s=void 0;try{for(var c,d=o[Symbol.iterator]();!(h=(c=d.next()).done);h=!0){var f=c.value,u=f.name,v=void 0===u?null:u,y=f.position,g=(y.x,y.y,(y.x-a.x)/a.width),p=(y.y-a.y)/a.height,b=Math.min(n.width/a.width,n.height/a.height),w=g*a.width*b,m=p*a.height*b,x=void 0;this.activeName===v?(this.drawCorn({x:w,y:m,context:i}),x=this.style.nodeActive):x=this.highlightName===v?this.style.nodeHighlight:this.style.node,i.beginPath(),i.fillStyle=x.fillStyle,i.strokeStyle=x.strokeStyle,i.lineWidth=x.lineWidth,i.ellipse(w,m,r,r,0,0,2*Math.PI),i.fill(),i.stroke()}}catch(t){l=!0,s=t}finally{try{!h&&d.return&&d.return()}finally{if(l)throw s}}}},{key:"drawCorn",value:function(t){var e=t.x,i=t.y,n=t.context,a=this.data,o=(a.viewRect.width+a.viewRect.height)/2,h=this.direction*r,l=this.perspective/2*r,s=Math.cos(h)*o,c=Math.sin(h)*o,d=Math.cos(h-l)*o,f=Math.sin(h-l)*o,u=Math.cos(h+l)*o,v=Math.sin(h+l)*o;n.beginPath();var y=n.createRadialGradient(e,i,0,e+s,i+c,o);y.addColorStop(0,"rgba(255, 255, 255, 1.0)"),y.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),n.fillStyle=y,n.moveTo(e,i),n.lineTo(e+d,i+f),n.quadraticCurveTo(e+1.3*s,i+1.3*c,e+u,i+v),n.fill()}}]),t}()});
