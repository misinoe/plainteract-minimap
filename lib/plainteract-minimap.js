!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Minimap=e()}(this,function(){"use strict";var t,e,i=(t=function(t){!function(e){var i=function(t){return r(!0===t,!1,arguments)};i.recursive=function(t){return r(!0===t,!0,arguments)},i.clone=function(t){var e,n,r=t,a=o(t);if("array"===a)for(r=[],n=t.length,e=0;e<n;++e)r[e]=i.clone(t[e]);else if("object"===a){r={};for(e in t)r[e]=i.clone(t[e])}return r};function n(t,e){if("object"!==o(t))return e;for(var i in e)"object"===o(t[i])&&"object"===o(e[i])?t[i]=n(t[i],e[i]):t[i]=e[i];return t}function r(t,e,r){var a=r[0],l=r.length;(t||"object"!==o(a))&&(a={});for(var h=0;h<l;++h){var s=r[h];if("object"===o(s))for(var c in s){var d=t?i.clone(s[c]):s[c];a[c]=e?n(a[c],d):d}}return a}function o(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}e?t.exports=i:window.merge=i}(t&&t.exports)},e=void 0,t(e={exports:{}},e.exports),e.exports),n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=Math.PI/180;return function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t);var o=i.recursive(!0,{background:{fillStyle:"rgba(0, 0, 0, 0.5)",strokeStyle:"rgba(0, 0, 0, 0.9)",lineWidth:1},node:{radius:5,fillStyle:"rgba(255, 255, 255, 0.2)",strokeStyle:"rgba(255, 255, 255, 0.5)",lineWidth:1},nodeActive:{radius:5,fillStyle:"rgba(255, 255, 255, 0.5)",strokeStyle:"rgba(255, 255, 255, 0.8)",lineWidth:4},nodeHighlight:{radius:5,fillStyle:"rgba(200, 240, 255, 0.7)",strokeStyle:"rgba(64, 128, 255, 0.9)",lineWidth:3},corn:{}},r.style||{});this.style=o;this.canvas=document.createElement("canvas");this.setMinimapData(e),this.direction=0,this.perspective=90,this.activeName="",this.highlightName=""}return r(t,[{key:"setMinimapData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.data=i.recursive(!0,{viewRect:{x:0,y:0,width:100,height:100},fieldRect:{x:0,y:0,width:400,height:300},nodes:[]},t);var e=this.canvas,n=this.data.viewRect;e.width=n.width,e.height=n.height,this.update()}},{key:"update",value:function(){var t=this.canvas,e=this.data,i=t.getContext("2d"),n=e.viewRect,r=e.fieldRect;r.y,r.height,r.x,r.width;i.clearRect(1,1,n.width,n.height),i.fillStyle=this.style.background.fillStyle,i.fillRect(1,1,n.width,n.height);var o=this.style.node.radius,a=e.nodes,l=!0,h=!1,s=void 0;try{for(var c,d=a[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var u=c.value,f=u.name,v=void 0===f?null:f,y=u.position,g=(y.x,y.y,(y.x-r.x)/r.width),b=(y.y-r.y)/r.height,p=Math.min(n.width/r.width,n.height/r.height),w=g*r.width*p,m=b*r.height*p,x=void 0;this.activeName===v?(this.drawCorn({x:w,y:m,context:i}),x=this.style.nodeActive):x=this.highlightName===v?this.style.nodeHighlight:this.style.node,i.beginPath(),i.fillStyle=x.fillStyle,i.strokeStyle=x.strokeStyle,i.lineWidth=x.lineWidth,i.ellipse(w,m,o,o,0,0,2*Math.PI),i.fill(),i.stroke()}}catch(t){h=!0,s=t}finally{try{!l&&d.return&&d.return()}finally{if(h)throw s}}}},{key:"drawCorn",value:function(t){var e=t.x,i=t.y,n=t.context,r=this.direction*o,a=this.perspective/2*o,l=100*Math.cos(r),h=100*Math.sin(r),s=100*Math.cos(r-a),c=100*Math.sin(r-a),d=100*Math.cos(r+a),u=100*Math.sin(r+a);n.beginPath();var f=n.createRadialGradient(e,i,0,e+l,i+h,100);f.addColorStop(0,"rgba(255, 255, 255, 1.0)"),f.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),n.fillStyle=f,n.moveTo(e,i),n.lineTo(e+s,i+c),n.quadraticCurveTo(e+1.3*l,i+1.3*h,e+d,i+u),n.fill()}}]),t}()});
