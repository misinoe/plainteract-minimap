!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Minimap=e()}(this,function(){"use strict";var t,e,i=(t=function(t){!function(e){var i=function(t){return r(!0===t,!1,arguments)};i.recursive=function(t){return r(!0===t,!0,arguments)},i.clone=function(t){var e,n,r=t,a=o(t);if("array"===a)for(r=[],n=t.length,e=0;e<n;++e)r[e]=i.clone(t[e]);else if("object"===a){r={};for(e in t)r[e]=i.clone(t[e])}return r};function n(t,e){if("object"!==o(t))return e;for(var i in e)"object"===o(t[i])&&"object"===o(e[i])?t[i]=n(t[i],e[i]):t[i]=e[i];return t}function r(t,e,r){var a=r[0],l=r.length;(t||"object"!==o(a))&&(a={});for(var c=0;c<l;++c){var s=r[c];if("object"===o(s))for(var h in s){var d=t?i.clone(s[h]):s[h];a[h]=e?n(a[h],d):d}}return a}function o(t){return{}.toString.call(t).slice(8,-1).toLowerCase()}e?t.exports=i:window.merge=i}(t&&t.exports)},e=void 0,t(e={exports:{}},e.exports),e.exports),n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=Math.PI/180;return function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t);var o=i.recursive(!0,{background:{fillStyle:"rgba(0, 0, 0, 0.5)",strokeStyle:"rgba(0, 0, 0, 0.9)",lineWidth:1},node:{radius:5,fillStyle:"rgba(255, 255, 255, 0.2)",strokeStyle:"rgba(255, 255, 255, 0.5)",lineWidth:1},nodeActive:{radius:5,fillStyle:"rgba(255, 255, 255, 0.5)",strokeStyle:"rgba(255, 255, 255, 0.8)",lineWidth:3},corn:{}},r.style||{});this.style=o;this.canvas=document.createElement("canvas");this.direction=0,this.perspective=90,this.activeName="position001",this.data=i.recursive(!0,{viewRect:{x:0,y:0,width:400,height:300},crop:{x:0,y:0,width:400,height:300},nodes:[{name:"position001",position:{x:150,y:100}},{name:"position002",position:{x:150,y:130}}]},e)}return r(t,[{key:"update",value:function(){var t=this.canvas,e=this.data,i=t.getContext("2d"),n=e.viewRect,r=e.crop,o=r.y+r.height,a=r.x+r.width;i.clearRect(1,1,n.width,n.height),i.fillStyle=this.style.background.fillStyle,i.fillRect(1,1,n.width,n.height);var l=this.style.node.radius,c=e.nodes,s=!0,h=!1,d=void 0;try{for(var f,u=c[Symbol.iterator]();!(s=(f=u.next()).done);s=!0){var v=f.value,y=v.name,p=void 0===y?null:y,g=v.position,b=g.x,x=g.y;if(!(b<=r.x||x<=r.y||b>=a||x>=o)){var w=(g.x-r.x)/r.width,S=(g.y-r.y)/r.height,m=w*n.width,k=S*n.height,M=void 0;this.activeName===p?(this.drawCorn({x:m,y:k,context:i}),M=this.style.nodeActive):M=this.style.node,i.beginPath(),i.fillStyle=M.fillStyle,i.strokeStyle=M.strokeStyle,i.lineWidth=M.lineWidth,i.ellipse(m,k,l,l,0,0,2*Math.PI),i.fill(),i.stroke()}}}catch(t){h=!0,d=t}finally{try{!s&&u.return&&u.return()}finally{if(h)throw d}}}},{key:"drawCorn",value:function(t){var e=t.x,i=t.y,n=t.context,r=this.direction*o,a=this.perspective/2*o,l=100*Math.cos(r),c=100*Math.sin(r),s=100*Math.cos(r-a),h=100*Math.sin(r-a),d=100*Math.cos(r+a),f=100*Math.sin(r+a);n.beginPath();var u=n.createRadialGradient(e,i,0,e+l,i+c,100);u.addColorStop(0,"rgba(255, 255, 255, 1.0)"),u.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),n.fillStyle=u,n.moveTo(e,i),n.lineTo(e+s,i+h),n.quadraticCurveTo(e+1.3*l,i+1.3*c,e+d,i+f),n.fill()}}]),t}()});
